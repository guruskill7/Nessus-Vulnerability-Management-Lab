# Nessus Essentials Vulnerability Management Lab #    

### Description ###    
This is a walkthrough of how I used **`Nessus Essential`** to scan hosts for vulnerabilities in a VMware ESXi environment.    
I did this project to gain experience with Nessus and learn how to scan and remediate vulnerabilities. This project will showcase some of the steps of the Vulnerability Management Lifecycle.     
I will use Nessus Essentials to scan local VMs hosted on VMWare ESXi. I will perform credentialed scans as well to discover vulnerabilities, remediate some vulnerabilities,    
and then perform a rescan to verify remediation.    

#### Utilities Used ####    
* Nessus Essentials   
* CMD    

#### Environments Used ####     
- VMWare ESXi   
- Windows 11 Pro    
- Windows 10 Pro   
#### Links ####    
- VMWare ESXi: [Download the ESXi Installer (vmware.com)](https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.esxi.install.doc/GUID-016E39C1-E8DB-486A-A235-55CAB242C351.html)    
- Activation Code Nessus Essentials: https://www.tenable.com/products/nessus/nessus-essentials    
- Download Nessus Essentials: https://www.tenable.com/downloads/nessus?loginAttempted=true    
  - https://www.tenable.com/downloads/tenable-appliance?loginAttempted=true#tenablecore-nessus     
- Download Nessus User Guide: https://docs.tenable.com/Nessus.htm     
- Windows 11 ISO: https://www.microsoft.com/en-us/software-download/windows11    
#### Program walk-through ####     
The first thing I am going to do is download and install Windows 10 and 11 in my VMware ESXi (I will not cover the tutorial for the Windows 10 and 11 installation here).     
Next, I will download and Install Nessus Essentials, the  Vulnerability management software we will use in this lab.     
For this lab, I set up **Tenable Core + Nessus** in VMware ESXi. Once you register and download Tenable Core + Nessus (OL8), you can follow the instructions below to configure it in VMware ESXi     

![Screenshot 2024-02-18 233502ofif](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/9c458815-4fbc-4e5b-a536-93e762d41dfc)       
![Screenshot 2024-02-16 214118](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/c6a7085f-53fb-4e48-a516-16bc064a70e2)    

**Once you start Nessus after installation in VMware ESXi, you will get to this page:**    

![Screenshot 2024-02-16 214242](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/b22f9346-d55b-435f-8329-280bb690b95b)    

The default login and password are: **login = wizard, password = admin**    
Next, configure a static IP for the scanner. Use the arrows to navigate here:    

![Screenshot 2024-02-16 214654](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/4fa8f117-d183-4631-8885-f979cd44712d)    
![Screenshot 2024-02-18 234034-7gf](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/e316dc6a-b05c-4d48-84ec-577fb19ef42c)     

You need to assign an available IP. Then provide a DNS Server. (if you are wondering how to find your DNS Server: Open your Command Prompt, type **ipconfig/all** and press Enter. Look for the field labeled **“DNS Servers.”** The first address is the primary DNS server, and the next address is the secondary DNS server.      

If you have  **Search domains** you can provide it there as well.     

![Screenshot 2024-02-18 234739dd](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/bbe62de4-cbec-4985-803b-c6abb0834bf4)     
![Screenshot 2024-02-16 220530](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/eec8f1d9-86f4-4ec4-bc3b-cdaca348d225)    

In the next window, you will be asked to create an administrator account from the terminal. You can do it there if you like but I prefer to do it on the URI since it requires a long password, which you can easily save in your Password Manager     

![Screenshot 2024-02-16 220630](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/31e9aeec-d2ec-4f7f-a0d4-7565d13195d9)     

**Now check that the IP was assigned correctly. [ip addr]**         

![Screenshot 2024-02-18 235038-45](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/214ad90e-e046-4682-b86d-6e9968614818)     

You can now access this from the web browser by typing the IP assigned in the web browser over port 8000. Something like this: https://192.168.0.151:8000/      

The initial login should be the same as previously mentioned (wizard/admin)     

![Screenshot 2024-02-16 221548](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/db42b1ce-b5c1-487f-98bb-6f5f30757365)    

Now you can create your logins
Once you successfully create your logins. You will be kicked out of the page. Once you log back in you will see a link to Nessus Scanner to set it up.    

![Screenshot 2024-02-16 222717](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/d1701944-5d8b-440c-a1de-d99e6653e8a7)     
![Screenshot 2024-02-16 223138](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/21f6c5da-4cc4-4cca-9a4a-4e1c22b34860)    

On the next page, you need to provide your activation code if you already have it from the initial step we covered.     

![Screenshot 2024-02-16 223221](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/6a139135-be39-4d12-b168-6abb54a19925)      
![Screenshot 2024-02-16 223421](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/c39c530a-2dc5-4b64-a448-ba8400ad1cb8)     

With Nessus plugins downloaded completely, it is ready for scanning.     

![Screenshot 2024-02-16 230207](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/40421f0e-fa4d-49b6-9695-06a112b044eb)     

Go to your VMs, get the IPs of the hosts you want to scan, and use them to create a scan Schedule in Nessus. But do make sure that those hosts are available for scanning.     

![Screenshot 2024-02-16 230923](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/563ef558-2071-4065-9f16-0675f5a36bb1)    

To do so, try pinging them, and if the ping timeout, try turning off the built-in firewall on the host and try again. ( We are disabling the firewall mainly for this lab. Otherwise, in a professional environment, this would not be recommended)    



On your window machine in the search bar near the start button, type **`wf.msc`** and hit enter or click on open    

![Screenshot 2024-02-17 161153](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/d00553c2-03f0-4f87-8b06-e39e72120fda)     

Then click on **Windows Defender Firewall Properties***     

![Screenshot 2024-02-17 161520](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/e8b2d3f7-20b7-439b-82da-b79bb73a2c38)    

**Navigate through the different taps (DomainProfile, Private Profile, Public Profile) and make sure the Firewall State is off.**     

![Screenshot 2024-02-17 162147](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/fb4e3c93-dd71-497f-9803-258256444b71)    
![Screenshot 2024-02-17 162343](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/6aae42db-a13a-4ead-91b0-55cf6b4ab8bc)    
![Screenshot 2024-02-17 162411](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/55ec0b8d-1325-4fa3-9ce2-b9e045631df1)     

Then hit Apply and OK. 

We now need to configure the Server and Remote Registry and set their “Startup type” to “automatic” as follows:    
On Windows, go to **`Services —> Remote Registry —-> Properties —> Startup Type = Automatic —> Apply → Ok`.**    

![Screenshot 2024-02-15 104259](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/b4039883-54bc-4777-91ff-52bf17dda209)     

**`Remote Registry —> Right-click → Start`**    
After that, within Services still:  **`Server —> Properties —>  Startup Type = Automatic —> Apply → OK`**. Then start it as well   

Next, make sure the Network discovery is on.    

Go to **`Control Panel —> Network and Internet —> Network and Sharing Center —> Advanced sharing settings`**. Make sure **“Turn on network discovery”** and **“Turn on file and printer sharing”** are selected.    

![Screenshot 2024-02-17 164807](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/fe1432fc-e5c6-43b7-9ddb-21479246123a)     
![Screenshot 2024-02-17 164842](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/e6b60b69-983a-4792-a518-b087f2fbc3f5)     

Go to **`User Account Control Settings`** and change it to never notify     

![Screenshot 2024-02-17 165027](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/272fec00-e1d7-451e-99f5-bdca071a424a)    
![Screenshot 2024-02-16 231241](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/72df2409-c952-46b2-b62d-aec6e29999f0)     

Now let’s go back to the Nessus Essential Dashboard. Click on **Create a new scan**. Then on **Basic Network Scan**.    

![Screenshot 2024-02-17 001138](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/b301f3c9-98c8-43c5-ac4e-72847dd1ec5c)   

Provide the name of the scan, a description if you like, and the scan targets     

![Screenshot 2024-02-17 002336](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/cf8575b7-3409-4d78-baf7-19ba4ed1f772)    

Let's set up a credential for scanning on the hosts   

![Screenshot 2024-02-17 003225](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/58ae8464-1a3a-4d6f-9a57-ed575e6cce3c)   

Then hit Save. and the start button to launch the scan.     

![Screenshot 2024-02-17 010336](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/7b8060c6-8e63-416a-8fb6-c282a88873aa)    
![Screenshot 2024-02-17 010503](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/7591abbd-5a68-4d70-87e1-c02425f8b7d8)    

Here is a display of the Scan Results    

![Screenshot 2024-02-17 011147](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/358e6514-618a-486d-bde3-a6341390ec36)     

Here are some of the vulnerabilities observed on both hosts (Windows 11 & Windows 10):

![Screenshot 2024-02-18 112905](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/98ae2d76-8557-4754-a1d6-3d67cebae13a)    
![Screenshot 2024-02-18 113048](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/84455c23-9938-4ebe-a0fb-57ef2e343a77)    


### Remediation: ###
Let’s remediate **“SMB Signing not required”**    
The mediation steps can be found here: https://learn.microsoft.com/en-US/troubleshoot/windows-server/networking/overview-server-message-block-signing     

After Completing the remediation on both machines for the **“SMB Signing not required”** vulnerability, let’s rescan the hosts and see if the remediation was successful     

![Screenshot 2024-02-18 122612](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/8c895cae-01ab-4785-b31b-e4af32aebd1a)     

From the result of the scan below, we can see that the remediation of the **“SMB Signing not required”** vulnerability, was successful on both hosts. You can notice that the risk is no longer showing up on the  
hosts/the scanner is no longer detecting it.    

![Screenshot 2024-02-18 123722](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/b0dd046d-8a5b-413f-985e-2b0774852de5)
![Screenshot 2024-02-18 123753](https://github.com/guruskill7/Nessus-Vulnerability-Management-Lab/assets/112531176/bcadb78d-fbfa-4ab1-b23e-0db6d32fd13b)


. 



